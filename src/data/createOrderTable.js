import pool from "../config/db.js";

const createOrderTable = async () => {

    const queryText=`CREATE TABLE IF NOT EXISTS public."order"
(
    id bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1 ),
    cid bigint,
    customer_name text COLLATE pg_catalog."default",
    customer_email text COLLATE pg_catalog."default",
    customer_phone text COLLATE pg_catalog."default",
    status text COLLATE pg_catalog."default",
    services text COLLATE pg_catalog."default",
    price text COLLATE pg_catalog."default",
    trndate timestamp with time zone,
    clients integer,
    assignedto bigint,
    createdat timestamp with time zone,
    modifiedat timestamp with time zone,
    order_no integer NOT NULL GENERATED ALWAYS AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    CONSTRAINT id PRIMARY KEY (id),
    CONSTRAINT assignedto FOREIGN KEY (assignedto)
        REFERENCES public."user" (id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION,
    CONSTRAINT cid FOREIGN KEY (cid)
        REFERENCES public.company (id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
)
        
TABLESPACE pg_default;

ALTER TABLE IF EXISTS public."order"
    OWNER to postgres;`;

    try {
        pool.query(queryText);
        console.log("Order Table Created");
    } catch (error) {
       
        console.log("Error Creating Order table :",error); 
    }
}

export default createOrderTable;